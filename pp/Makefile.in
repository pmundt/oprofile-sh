include ../make.common

OPROFPP_HEADERS=oprofpp.h samples_container.h demangle_symbol.h opp_symbol.h
OP_TO_SOURCE_HEADERS=
OP_TIME_HEADERS=
OP_MERGE_HEADERS=
HEADERS=$(OPROFPP_HEADERS) $(OP_TO_SOURCE_HEADERS) $(OP_TIME_HEADERS) $(OP_MERGE_HEADERS)

OPROFPP_SOURCES=oprofpp.cpp oprofpp_util.cpp opp_symbol.cpp demangle_symbol.cpp
OP_TO_SOURCE_SOURCES=op_to_source.cpp
OP_TIME_SOURCES=op_time.cpp
OP_MERGE_SOURCES=op_merge.cpp
SOURCES=$(OPROFPP_SOURCES) $(OP_TO_SOURCE_SOURCES) $(OP_TIME_SOURCES) $(OP_MERGE_SOURCES)

OPROFPP_OBJECTS=oprofpp.o oprofpp_util.o samples_container.o opp_symbol.o demangle_symbol.o
OP_TO_SOURCE_OBJECTS=oprofpp_util.o op_to_source.o samples_container.o demangle_symbol.o
OP_TIME_OBJECTS=op_time.o oprofpp_util.o samples_container.o demangle_symbol.o opp_symbol.o
OP_MERGE_OBJECTS=op_merge.o oprofpp_util.o
OBJECTS=$(OPROFPP_OBJECTS) $(OP_TO_SOURCE_OBJECTS) $(OP_TIME_OBJECTS) $(OP_MERGE_OBJECTS)

OPROFPP_TARGET=oprofpp
OP_TO_SOURCE_TARGET=op_to_source
OP_TIME_TARGET=op_time
OP_MERGE_TARGET=op_merge
TARGET=$(OPROFPP_TARGET) $(OP_TO_SOURCE_TARGET) $(OP_TIME_TARGET) $(OP_MERGE_TARGET)

OPROFPP_LIBS=-lop -lutil++ -lutil -ldb -lpopt -lbfd -liberty -ldl
OP_TO_SOURCE_LIBS=-lop -lutil++ -lutil -ldb -lpopt -lbfd -liberty -ldl
OP_TIME_LIBS=-lop -lutil++ -lutil -ldb -lpopt -lbfd -liberty -ldl
OP_MERGE_LIBS=-lop -lutil++ -lutil -ldb -lpopt -lbfd -liberty -ldl

all: $(TARGET)

INSTALL_LIST=$(TARGET)
install:
	$(INSTALL) $(INSTALL_LIST) $(BINDIR)

uninstall:
	for f in $(INSTALL_LIST); do rm -f $(BINDIR)/$$f; done

clean:
	rm -rf .deps $(OBJECTS) $(TARGET) 

$(OPROFPP_TARGET): $(OPROFPP_OBJECTS)
	$(CXX) -o $@ $^ $(LDFLAGS) $(OPROFPP_LIBS)

$(OP_TO_SOURCE_TARGET): $(OP_TO_SOURCE_OBJECTS)
	$(CXX) -o $@ $^ $(LDFLAGS) $(OP_TO_SOURCE_LIBS)

$(OP_TIME_TARGET): $(OP_TIME_OBJECTS)
	$(CXX) -o $@ $^ $(LDFLAGS) $(OP_TIME_LIBS)

$(OP_MERGE_TARGET): $(OP_MERGE_OBJECTS)
	$(CXX) -o $@ $^ $(LDFLAGS) $(OP_MERGE_LIBS)

include ../make.deps
