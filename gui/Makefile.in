ifneq "@have_qt@" "yes"
all:
install:
uninstall:
clean:
else

include ../make.common

MOC=@MOC@
 
HEADERS=oprof_start.h oprof_start_config.h oprof_start_util.h persistent_config.h
SOURCES=oprof_start.cpp oprof_start_config.cpp oprof_start_util.cpp oprof_start_main.cpp
OBJECTS=ui/oprof_start.base.o ui/oprof_start.base.moc.o \
	oprof_start.o oprof_start_config.o oprof_start_util.o oprof_start_main.o \
	oprof_start.moc.o
TARGET=oprof_start

CXXFLAGS += -DBINDIR=\"$(BINDIR)\" -DKVERSION=\"@KVERS@\" @QT_INCLUDES@
CXX_CPPFLAGS_DEPS =  @QT_INCLUDES@
LDFLAGS += @QT_LDFLAGS@
LIBS=-lutil++ -lutil -lop -lpopt -liberty @QT_LIBS@
LIB_DEPS=../libutil++/libutil++.a ../libutil/libutil.a ../libop/libop.a

all: $(TARGET)
 
.deps/oprof_start_config.cpp.d .deps/oprof_start_util.cpp.d .deps/oprof_start_main.cpp.d .deps/oprof_start.cpp.d: .buildui
 
oprof_start.moc.cpp: oprof_start.h
	$(MOC) -o $@ oprof_start.h
oprof_start.moc.o: oprof_start.moc.cpp ui/oprof_start.base.h

.buildui:
	$(MAKE) -C ui
	$(TOUCH) $@

INSTALL_LIST=oprof_start
install:
	$(INSTALL) $(INSTALL_LIST) $(BINDIR)
 
uninstall:
	for f in $(INSTALL_LIST); do rm -f $(BINDIR)/$$f; done
	@echo "---------------------------------------------------------------"
	@echo "The uninstall target does not remove your ~/.oprofile directory"
	@echo "---------------------------------------------------------------" 
 
clean:
	$(MAKE) -C ui clean
	rm -rf .deps $(OBJECTS) $(TARGET) .buildui oprof_start.moc.cpp

$(TARGET): .buildui $(OBJECTS) $(LIB_DEPS)
	$(CXX) -o $@ $(OBJECTS) $(LDFLAGS) $(LIBS)
 
include ../make.deps
 
endif 
