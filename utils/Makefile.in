include ../make.common

HEADERS=
 
OP_SESSION_SOURCES=op_session.c
OP_HELP_SOURCES=op_help.c
SOURCES=$(OP_SESSION_SOURCES) $(OP_HELP_SOURCES)

OP_SESSION_OBJECTS=op_session.o
OP_HELP_OBJECTS=op_help.o
OBJECTS=$(OP_SESSION_OBJECTS) $(OP_HELP_OBJECTS)

OP_SESSION_TARGET=op_session
OP_HELP_TARGET=op_help
TARGET=$(OP_SESSION_TARGET) $(OP_HELP_TARGET)

OP_SESSION_LIBS=-lutil -lpopt -liberty
OP_HELP_LIBS=-lutil -lop -lpopt -liberty

OP_SESSION_LIBDEPS=../libutil/libutil.a
OP_HELP_LIBDEPS=../libutil/libutil.a ../libop/libop.a

all: $(TARGET)

ifeq "@OPROFILE_25@" "no"
OP_START=op_start
OP_STOP=op_stop
OP_DUMP=op_dump
else
OP_START=op_start_25
OP_STOP=op_stop_25
OP_DUMP=
endif
 
INSTALL_LIST=op_help $(OP_DUMP) op_session op_stop
install:
	$(INSTALL) $(INSTALL_LIST) $(BINDIR)
	$(INSTALL) $(OP_START) $(BINDIR)/op_start
	$(INSTALL) $(OP_STOP) $(BINDIR)/op_stop

uninstall:
	for f in $(INSTALL_LIST); do rm -f $(BINDIR)/$$f; done

clean:
	rm -rf .deps $(OBJECTS) $(TARGET) 

$(OP_SESSION_TARGET): $(OP_SESSION_OBJECTS) $(OP_SESSION_LIBDEPS)
	$(CC) -o $@ $(OP_SESSION_OBJECTS) $(LDFLAGS) $(OP_SESSION_LIBS)

$(OP_HELP_TARGET): $(OP_HELP_OBJECTS) $(OP_HELP_LIBDEPS)
	$(CC) -o $@ $(OP_HELP_OBJECTS) $(LDFLAGS) $(OP_HELP_LIBS)

include ../make.deps
